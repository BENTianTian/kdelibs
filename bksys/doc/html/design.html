<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BKSYS - Build Kde SYStem: Design</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1><a class="anchor" name="design">Design</a></h1><pre>
## started by Thomas Nagy (aka ita on freenode)</pre><p>
<pre>SUMMARY:
 HOW TO RUN
 THE API
 STRUCTURE OF THE MODULES
 DISCUSSION</pre><p>
<pre>HOW TO RUN:
-----------</pre><p>
<pre> without scons installed:
cd kdelibs
tar xjvf bksys/scons-mini.tar.bz2
./scons configure
./scons</pre><p>
<pre> with scons installed:
cd kdelibs &amp;&amp; scons
add this to your .bashrc to run scons anywhere in the tree
export SCONSFLAGS="-u"</pre><p>
<pre>Miniscons is based on scons-0.96.1, but the version 0.96.91
is about 30% faster at computing the dependencies</pre><p>
<pre>To make scons run faster you may use these flags:
export SCONSFLAGS="-u --max-drift=1 --implicit-deps-unchanged",
but in this case Miniscons and 0.96.91 are about as fast</pre><p>
<pre>To install:
scons install DESTDIR=/tmp/blah</pre><p>
<pre>THE API:
--------</pre><p>
<pre>For building objects, one will use the 'obj' builders.
These are python classes that accept 5 types when initialized:
program      : compiled program
shlib        : shared library
staticlib    : static library
convenience  : static library made of objects compiled with pic (position-independent code)
kioslave     : same as shlib, but without 'lib' as a prefix</pre><p>
<pre>The existing classes are the following:
 genobj:     build generic c++ or c applications, depending on the sources given to build
 qt4obj:     build a <a class="el" href="namespaceqt4.html">qt4</a> object, scanning for moc files and adding the dependencies on .rcc files
 kde4obj:    build a <a class="el" href="namespacekde4.html">kde4</a> object, scanning for ... 
 kdeinitobj: build a kdeinit object, scanning for ...</pre><p>
<pre>Targets are then specified like this:
obj = env.qt4obj('shlib',env)
obj.vnum     = '6.0.2'
obj.target   = 'libDCOP'
obj.source   = 'dcopstub.cpp dcopref.cpp dcopobject.cpp dcopclient.cpp'
obj.uselib   = 'QTCORE QT3SUPPORT KDE4'
obj.libs     = <a class="el" href="namespacegeneric.html#a29">env.join</a>('KDE-ICE', 'libkICE.a')
obj.execute()</pre><p>
<pre>More to come:
obj.findfile = '. gui algos' # scan for source files automatically</pre><p>
<pre>STRUCTURE OF THE MODULES:
-------------------------</pre><p>
<pre>A scons module must contain the following functions:
 exists(env)
	returns True usually
 generate(env) 
	attach to the env the necessary builders and detect the configuration</pre><p>
<pre> Suggested layout for the modules:
bksys/
bksys/unix
bksys/win32
bksys/osx</pre><p>
<pre>If possible add the platform specific code to those directories and import the code needed like this
import sys
if sys.platform == 'darwin':
   sys.path.append('bksys'+os.sep+'osx')
   from somemodule import runfunction
   runfunction(env)
else:
   ...</pre><p>
<pre> There will be one config.h in build which will include all other configuration files</pre><p>
<pre>DISCUSSION:
-----------</pre><p>
<pre>No more question for the moment :)</pre><p>
<pre>BUGS:
-----
see BUGS.TXT</pre><p>
<pre>TODO:
-----
see TODO.TXT and search for TODO tags in the python sources</pre><p>
<pre>RULES:
-----
see RULES.TXT for some programming rules</pre><p>
<pre></pre> <hr size="1"><address style="align: right;"><small>Generated on Sun Oct 23 01:55:17 2005 for BKSYS - Build Kde SYStem by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
