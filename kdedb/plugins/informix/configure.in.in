dnl ================
dnl checks for Informix
dnl ================

AC_ARG_ENABLE(informix, [  --enable-informix              build Informix-plugin [default=yes]],
              informix_plugin=$enableval, informix_plugin=yes)

AC_ARG_WITH(informixincdir,
[  --with-informix-includes=DIR   use Informix-includes installed in this directory ],
[
  ac_informix_incdir=$withval
], ac_informix_incdir=/opt/informix/incl
)

AC_ARG_WITH(informixlibdir,
[  --with-informix-libraries=DIR  use Informix-libs installed in this directory ],
[
  ac_informix_libdir=$withval
], ac_informix_libdir=/opt/informix/lib
)

dnl check for Informix should be compiled
dnl and where headers and libraries are installed
dnl if present compile informix-plugin

AC_MSG_CHECKING([for Informix])

compile_informix_plugin="yes"

if test "x$informix_plugin" != "xyes"; then
  compile_informix_plugin="no"
fi

dnl check header files
informix_incdirs="$ac_informix_incdir /opt/informix/incl/esql /usr/include /usr/local/include"
AC_FIND_FILE(esqlc.h, $informix_incdirs, informix_incdir)
if test ! -r $informix_incdir/esqlc.h; then
  compile_informix_plugin="no"
else
  INFORMIX_INCDIR=$informix_incdir
  AC_SUBST(INFORMIX_INCDIR)
fi

dnl check libraries
informix_libdirs="$ac_informix_libdir /opt/informix/lib/esql /usr/lib /usr/local/lib"
AC_FIND_FILE(libgen.a, $informix_libdirs, informix_libdir)
if test ! -r $informix_libdir/libgen.a; then
  compile_informix_plugin="no"
else
  INFORMIX_LIBDIR=$informix_libdir
  AC_SUBST(INFORMIX_LIBDIR)
fi

if test "$compile_informix_plugin" = "yes"; then
  AC_MSG_RESULT([libraries $informix_libdir, headers $informix_incdir])
  
  PLUGINS="$PLUGINS informix"
  AC_SUBST(PLUGINS)
else
  AC_MSG_RESULT(not found)
fi
