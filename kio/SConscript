#! /usr/bin/env python

Import('env')

env.subdirs('kssl kio bookmarks kfile kpasswdserver')

obj = env.kdeobj('shlib', env)
obj.target   = 'libkio'
obj.vnum     = '6.0.2'
obj.source   = "dummy.cpp"
obj.iskdelib = 1
obj.linkflags = '-Wl,--whole-archive build/kio/kssl/libkssl.a build/kio/kio/libkiocore.a build/kio/kio/libksycoca.a build/kio/bookmarks/libkbookmarks.a build/kio/kfile/libkfile.a -Wl,--no-whole-archive'
obj.uselib   = 'QT QTCORE QTGUI QTXML QT3SUPPORT KDE4 FAM'
obj.libpaths = '../kdecore ../dcop'
obj.libs     = '../kdeui/libkdeui.la ../kdesu/libkdesu.la ../kwallet/client/libkwalletclient.la kdecore DCOP'
#$(LIBZ) $(LIBFAM) $(LIBVOLMGT)

env.CreateFile('dummy.cpp', Value(''))

obj.execute()
# For now ;(
env.Depends('libkio.so.6.0.2', 'kio/libkiocore.a')
env.Depends('libkio.so.6.0.2', 'kio/libksycoca.a')
env.Depends('libkio.so.6.0.2', 'bookmarks/libkbookmarks.a')
env.Depends('libkio.so.6.0.2', 'kfile/libkfile.a')
env.Depends('libkio.so.6.0.2', 'kssl/libkssl.a')

servicetypes = [ 'application.desktop', 'kurifilterplugin.desktop', 'kcomprfilter.desktop', 'kscan.desktop', 
'kdatatool.desktop', 'kfileplugin.desktop', 'kcmodule.desktop', 'renamedlgplugin.desktop' ]

env.bksys_insttype('KDESERVTYPES','', servicetypes)
env.bksys_insttype('KDESERV','', 'data.protocol')
env.bksys_insttype('KDESERV','kded', 'kpasswdserver.desktop')
env.bksys_insttype('KDEAPPS','kconf_update', [ 'kioslave.upd', 'proxytype.pl', 'useragent.pl' ])
env.bksys_insttype('KDEMIME','','magic')
